---
title: CVE-2020-1957
date: 2023-09-03T15:29:52+08:00
updated: 2023-08-29T02:56:07+08:00
categories: 
- 渗透测试
- 漏洞复现
- shiro
---

## 漏洞成因

Apache Shiro 1.5.2之前版本中存在安全漏洞。攻击者可借助特制的请求利用该漏洞绕过身份验证。

Shiro框架通过拦截器功能来对用户访问权限进行控制，如anon, authc等拦截器。anon为匿名拦截器，不需要登录即可访问；authc为登录拦截器，需要登录才可以访问。Shiro的URL路径表达式为Ant格式，路径通配符*表示匹配零个或多个字符串，/*可以匹配/hello，但是匹配不到/hello/，因为*通配符无法匹配路径。假设/hello接口设置了authc拦截器，访问/hello会进行权限判断，但如果访问的是/hello/，那么将无法正确匹配URL，直接放行，进入到spring拦截器。spring中的/hello和/hello/形式的URL访问的资源是一样的，从而实现了权限绕过。

## 漏洞利用

直接访问漏洞存在的admin界面

![2020](E:\笔记软件\笔记\渗透测试\漏洞复现\shiro\2020.png)

直接302跳转到登录界面，访问/xxxx/..;/admin/

![2020-2](E:\笔记软件\笔记\渗透测试\漏洞复现\shiro\2020-2.png)

成功越权访问到admin界面

shiro校验url得到/xxxx/..通过验证，访问到admin