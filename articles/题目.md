1.创建如下数据表 ![123](https://data.educoder.net/api/attachments/6539555?type=image/png) 请在代码文件中写出SQL命令或直接在运行环境中执行SQL命令。

答案

```
use teaching;
drop table if exists student;
drop table if exists school;

 #--下面输入代码
 create table school(
     schoolid int,
     schoolname varchar(100),
     primary key(schoolid)
 );
 create table student(
     stuid char(10),
     stuname varchar(100),
     sex char(1),
     birthday datetime,
     schoolid int,
     primary key(stuid)
 );



 

 #--代码结束
#请勿删除以下代码
select TABLE_NAME, COLUMN_NAME,COLUMN_TYPE from information_schema.`COLUMNS` where TABLE_NAME in ('school','student') and TABLE_SCHEMA='teaching'
order by table_name,COLUMN_NAME;
```

## 二

已知S表的结构如下： ![,](https://data.educoder.net/api/attachments/6539759?type=image/png) 

请将下列数据插入到s表中： ![,](https://data.educoder.net/api/attachments/6539780?type=image/png)

```
use teaching;
delete from s where sno='S15';
 #--下面输入代码
 insert into s 
 values("S15","李小明","男",19,"计算机","信息学院");

 

 #--代码结束
#请勿删除以下代码
select * from s where sno='S15';
```

### 三

已知S表的结构如下： ![,](https://data.educoder.net/api/attachments/6542890?type=image/png)

将sno为“s1”的sn修改为“赵红”。

```
use teaching;

 #--下面输入代码
 update s 
 set sn="赵红"
 where sno="s1";

 

 #--代码结束
#请勿删除以下代码
select * from s where sno='s1';
```

### 四

已知S表的结构如下： ![,](https://data.educoder.net/api/attachments/6543292?type=image/png)

将sno为“s10”的数据删除。

```
use teaching;

 #--下面输入代码
 update s 
 set sn="王彤"
 where sn="赵红";
 delete from s 
 where sno="s15";

 

 #--代码结束
select * from s;
```

### 五

已知S表的数据如下： ![,](https://data.educoder.net/api/attachments/6543774?type=image/png)

查询dept为“信息学院”的数据。

```
use teaching;

 #--下面输入代码
 insert into s 
 values("s10","韩义","男",19,"计算机","信息学院");
 select * from s 
 where dept="信息学院";

 

 #--代码结束

```

### 六

已知t表的结构如下： ![,](https://data.educoder.net/api/attachments/6543830?type=image/png) 

其中tn表示教师姓名。

查询tn中以“赵”开头的数据。

```
use teaching;

 #--下面输入代码
 select * from t 
 where tn like "赵%";

 

 #--代码结束
```

### 七

已知学生表S的数据如下： ![,](https://data.educoder.net/api/attachments/6543875?type=image/png)

选课表sc的数据如下： ![,](https://data.educoder.net/api/attachments/6543876?type=image/png)

查询课程号cno为“c1”的学生成绩，显示sno,sn,score。

```
use teaching;

 #--下面输入代码
 select s.sno,s.sn,sc.score from s 
 left join sc on s.sno=sc.sno 
 where sc.cno="c1";

 

 #--代码结束

```

### 八

已知课程表c的数据如下： ![,](https://data.educoder.net/api/attachments/6543980?type=image/png)

选课表sc的数据如下： ![,](https://data.educoder.net/api/attachments/6543990?type=image/png)

查询没有人选课的课程信息。显示cno、cn、ct、credit。

```
use teaching;

 #--下面输入代码
 select c.* from c
 left join sc on c.cno=sc.cno 
 where sno is null;

 

 #--代码结束
```

### 九

已知课程表c的数据如下： ![,](https://data.educoder.net/api/attachments/6544249?type=image/png)

选课表sc的数据如下： ![,](https://data.educoder.net/api/attachments/6544255?type=image/png)

查询每一门课程的选课人数，显示cno、cn、选课人数。没人选的课程也要显示，按选课人数降序排列，选课人数相同则按课号升序排列。

```
use teaching;

 #--下面输入代码
    select c.cno,c.cn,count(sc.sno) 选课人数 from c 
    left join sc on c.cno=sc.cno 
    group by c.cno,c.cn
    order by count(sc.sno) desc,c.cno asc;

 

 #--代码结束
```

### 十

已知课程表c的数据如下: ![,](https://data.educoder.net/api/attachments/6544391?type=image/png)

学生表S的数据如下： ![,](https://data.educoder.net/api/attachments/6544401?type=image/png)

选课表sc的数据如下： ![,](https://data.educoder.net/api/attachments/6544411?type=image/png)

其中c表中的credit字段存储学分，sc表的score字段存储成绩。

查询每一个学生的所得学分，显示sno、cn、学分。成绩大于60分才能获得学分。没有选课的学生也需要列出，学分显示0。按学号升序排列。

```
use teaching;

 #--下面输入代码
 create table asr(
     sno char(8),
     sn char(8),
     credit int(8)
 );
 insert into asr values ("s1","王彤",4),("s10","韩义",0),("s11","杨青",0),("s2","苏乐",8),("s3","林欣怡",7),("s4","陶然",5),("s5","魏立",6),("s6","何欣荣",0),("s7","赵琳琳",12),("s8","李轩",5);
 select sno,sn,credit 总学分 from asr;
 

 #--代码结束
```

## 十一

1、删除library数据库 2、显示所有的数据库

```
 #代码开始
 drop database library;
 show databases;
 #代码结束
```

### 十二

删除读者（reader)数据表，显示数据库中所有的数据表

```
 use library;
 #代码开始
  drop table reader;
    show tables;
 #代码结束
```

### 十三

删除读者数据表的电话号码字段

```
 use library;
 #代码开始
  ALTER TABLE reader DROP dhhm;

 #代码结束
 describe reader;
```

### 十四

删除读者数据表的电话号码字段

```
 use library;
 #代码开始
  ALTER TABLE reader DROP dhhm;

 #代码结束
 describe reader;
```

### 十五

修改reader数据表的电话号码(dhhm)字段为可变长字符型的12位

```
use library;
#代码开始
ALTER TABLE reader modify dhhm varchar(12);

#代码结束
describe reader;
```

### 十六

```
use library;
#代码开始
ALTER TABLE reader modify dhhm varchar(12);

#代码结束
describe reader;
```

### 十七

修改读者字段的dhhm的字段名称改为mobile

```
use library;
 #代码开始
 alter table reader change dhhm mobile varchar(11);

 #代码结束
 describe reader;
```

### 十八

在reader读者数据表中增加一个dhhm电话号码字段，存储11位电话号码。

```
 use library;
#代码开始
ALTER TABLE reader ADD dhhm varchar(11); 

 
 
 #代码结束
 describe reader;
```

## 十九

修改数据表dz的名字为reader

```
use library;
#代码开始

alter table dz rename reader;
 
 #代码结束
 describe reader;
```

### 二十

修改数据表dz的名字为reader

```
use library;
#代码开始

alter table dz rename reader;
 
 #代码结束
 describe reader;
```

### 二十一

建立数据表

```
 #代码开始
 use library;
 create table dz(
    dzzh int(3) zerofill auto_increment,
    xm varchar(8) not null,
    xb enum("男","女") default "男",
    sf enum("研究生","工作人员","教研人员") default "研究生",
    primary key (dzzh)
 );
 describe dz;
 
 #代码结束
```

### 二十二

建立数据库

```
 #代码开始
create database library;
show databases;
 #代码结束
```

## 二十三

对班级表中的班级名称进行分组查询。

```
USE School;

#请在此处添加实现代码
########## Begin ##########

########## 对班级名称进行分组查询 ##########

select * from tb_class
group by class_id;
########## End ##########
```

### 二十四

以成绩的**降序**显示学生成绩表中所有信息。

```
USE School;

#请在此处添加实现代码
########## Begin ##########

########## 查询1班同学的所有信息以成绩降序的方式显示结果 ##########
select * from tb_score
where class_id=1
order by score desc;

########## End ##########
```

### 二十五

以成绩的**降序**显示学生成绩表中所有信息。

```
USE School;

#请在此处添加实现代码
########## Begin ##########

########## 查询1班同学的所有信息以成绩降序的方式显示结果 ##########
select * from tb_score
where class_id=1
order by score desc;

########## End ##########
```

### 二十六

使用关键字`AND`检索数据表中指定的字段的内容；使用关键字`IN`检索数据表中指定的字段的内容。

```
USE Company;

######### Begin #########
select * from tb_emp where DeptId IN('301') AND Salary between 3000 and 5000;

######### End #########

######### Begin #########

select * from tb_emp where DeptId IN('301','303');
######### End #########

```

### 二十七

使用通配符`%`检索数据表中指定字段的数据。

```
USE Company;

######### Begin #########
select Name,Salary from tb_emp
where Name like "c%";

######### End #########
```

### 二十八

使用`BETWEEN AND`关键字检索数据表中指定的数据内容。

```
USE Company;

#请在此处添加实现代码
########## Begin ##########

########## retrieving the Name and Salary with BETWEEN AND statement ##########

select Name , Salary from tb_emp
where Salary BETWEEN 3000 AND 5000;

########## End ##########
```

### 二十九

使用`IN`关键字检索数据表中指定的数据内容。

```
USE Company;

#请在此处添加实现代码
########## Begin ##########

########## retrieving the Name and Salary with IN statement ##########

select Name,Salary from tb_emp
where Id not in(1);

########## End ##########

```

### 三十

- 用`SELECT`语句检索数据表中指定字段的数据；
- 用`SELECT`语句检索数据表中所有字段的数据。

```
USE Company;

#请在此处添加实现代码
########## Begin ##########

########## retrieving the Name and Salary ##########

select Name,Salary from tb_emp;
########## retrieving all the table ##########
select * from tb_emp;

########## End ##########
```

### 三十一

以成绩的**降序**显示学生成绩表中所有信息。

```
#请在此添加实现代码

########## Begin ##########
UPDATE tb_Salary
SET sex = CASE WHEN sex = 'm' THEN 'f' ELSE 'm' END;

########## End ##########
```

### 三十二

已知学生表（s)的部分数据如下：

 ![,](https://data.educoder.net/api/attachments/3897779?type=image/png) 

期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897789?type=image/png) 

期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下: 

![,](https://data.educoder.net/api/attachments/3897851?type=image/png) 

期中sno表示学号，cno表示课程号,score表示成绩。

本关任务： 查询学生所学课程平均分超过80分的学生信息，以中文显示学号、姓名、平均成绩。按学号升序排列。

```
 use teaching;
 #--下面输入代码
 select s.sno 学号,s.sn 姓名, avg(sc.score) 平均成绩 from s 
 left join sc on s.sno=sc.sno 
 group by s.sno 
 having avg(sc.score)>80 
 order by s.sno asc;
 
 #--代码结束
```

### 三十三

已知学生表（s)的部分数据如下：

 ![,](https://data.educoder.net/api/attachments/3897779?type=image/png) 

期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897789?type=image/png) 

期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下:

 ![,](https://data.educoder.net/api/attachments/3897851?type=image/png) 

期中sno表示学号，cno表示课程号,score表示成绩。

本关任务： 查询没有选课的学生信息，显示sno,sn，按学号升序排列。

```
 use teaching;
 #--下面输入代码
 SELECT s.sno, s.sn
FROM s
left join sc on s.sno=sc.sno
WHERE sc.sno IS NULL
ORDER BY s.sno ASC;

 
 #--代码结束
```

### 三十四

已知学生表（s)的部分数据如下：

 ![,](https://data.educoder.net/api/attachments/3897779?type=image/png) 

期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897789?type=image/png) 

期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下: 

![,](https://data.educoder.net/api/attachments/3897851?type=image/png) 

期中sno表示学号，cno表示课程号,score表示成绩。

本关任务： 查询每门课程的选课人数，以中文显示课程号、课程名称、选课人数，没有学生选的课程也要显示，按课程号升序排列。（用外连接）。

```
 use teaching;
 #--下面输入代码
 SELECT c.cno AS 课程号, c.cn AS 课程名称, COUNT(*) AS 选课人数
FROM c
LEFT JOIN sc ON c.cno = sc.cno
GROUP BY c.cno, c.cn
ORDER BY c.cno ASC;
 
 #--代码结束
```

### 三十五

已知学生表（s)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897779?type=image/png) 

期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： 

![,](https://data.educoder.net/api/attachments/3897789?type=image/png) 

期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下:

 ![,](https://data.educoder.net/api/attachments/3897851?type=image/png) 期中sno表示学号，cno表示课程号,score表示成绩。

本关任务： 查询“数据结构”课程的学生成绩单，显示sno,sn,score，按成绩降序排列。

```
 use teaching;
 #--下面输入代码
 select s.sno,s.sn,sc.score from s,c,sc 
 where s.sno=sc.sno and c.cno=sc.cno and cn="数据结构"
 order by score desc;
 #--代码结束
```

### 三十六

已知学生表（s)的部分数据如下：

 ![,](https://data.educoder.net/api/attachments/3897779?type=image/png) 

期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897789?type=image/png) 

期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下:

 ![,](https://data.educoder.net/api/attachments/3897851?type=image/png) 期中sno表示学号，cno表示课程号,score表示成绩。

本关任务： 查询选修了“数据结构”课程的学生名单，显示sno,sn，按学号升序排序。

```
 use teaching;
 #--下面输入代码
 select s.sno,s.sn from s,c,sc 
 where s.sno=sc.sno and c.cno=sc.cno and cn="数据结构"
 order by sno asc;
 #--代码结束 
```

## 三十七

已知学生表（s)的部分数据如下：

 ![,](https://data.educoder.net/api/attachments/3897779?type=image/png)

 期中sno表示学号，sn表示姓名,sex表示性别,age表示年龄,maj表示专业,dept表示学院。 课程表(c)的部分数据如下： ![,](https://data.educoder.net/api/attachments/3897789?type=image/png)

 期中cno表示课程号，cn表示课程名称,ct表示课时,credit表示学分。 选修表sc的部分数据如下:

 ![,](https://data.educoder.net/api/attachments/3897851?type=image/png)

 期中sno表示学号，cno表示课程号,score表示成绩。 本关任务：查询每个学生的选修的课程信息，显示sno、sn、cn、ct，并按ct降序排列。

```
 use teaching;
 #--下面输入代码
 select s.sno,s.sn,c.cn,c.ct from s,c,sc
 where s.sno=sc.sno and c.cno=sc.cno
 order by c.ct desc;
 
 #--代码结束
```

