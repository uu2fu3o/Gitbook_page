### 成都大运会护网

我负责对部分目标进行信息收集以及外网打点工作，信息收集方面采用ksubdomain和jsfinder对子域名进行收集，将收集到的子域名进行未授权的扫描，采用ehole进行重点资产的识别，列出重点资产使用awvs和xray进行漏扫，以及部分资产的手动测试。

某企业的登录界面存在sql注入，当时sqlmap已经能够识别出数据库版本了，通过查找，发现对方开启了慢查询日志，通过报错找到了绝对路径，使用慢日志查询，成功将shell写到了对方的网站下，使用蚁剑进行连接，通过查询systeminfo信息，将其放到windows提权辅助网站上进行查询，最后是通过badpotato成功提权到了system,通过cs的powershell一句话将shell发送到cs上。

之后上传mimikatz进行密码抓取，尝试直接抓取失败了。通过mimikatz自带的mimidrv.sys删除lsass的保护措施，成功抓取到可以用于横向的密码。通过psexec就成功横向到了另外一台机器。

经过查询，当前域内存在exchange，并且存在web服务，并且当前获取到的用户可以进行登录。读取到了部分邮件信息。

### 企业渗透测试

负责与客户进行对接，到客户现场按照要求对指定的4台机器进行渗透测试，采用的是awvs+goby以及手测的形式。对方的电力查询系统使用tomcat框架，经过测试，发现存在弱口令漏洞，成功登录后台，上传jar包getshell。

教管融合平台，经过抓包测试，发现存在水平越权，学生可以通过id修改对方的用户名。

3台机器都存在一定数量的xss，通过xsstrike测试得出。

### 成都大运会舆论检测

使用深信服的舆论监测设备，负责对设备的报警内容进行排查是否符合封禁条件，符合就联系主办方进行封禁

### 卡巴斯基，quick heal杀软日志分析

在本地运行卡巴斯基和quick heal杀软，负责分析部分监测功能运行产生的日志，通过对照官方的开发手册，分析日志当中的字段内容，并将其写入到数据库当中。

### 安洵杯线下出题,运维

负责域内的部分机器。其中一台机器部署为exchange服务，邮件内容为flag。

### AI建模工具

负责前端模型的渲染，展示，负责图形处理AI的使用，使用python操控AI模型对图片进行抠图处理，并将处理好的图片发送到下一个模型构建AI。该项目获得黑客马拉松2023 AIGC赛道冠军

### 云原生安全监测工具

负责恶意行为监测，敏感日志获取功能模块的编写。以及将整个项目部署到k8s集群的工作。恶意行为监测通过编写基于BCC框架的ebpf程序监测linux内核的execve调用，并通过python加载event，能够做到获取容器包括宿主机所有进程的pid,执行的命令以及cgroup信息，从而准确定位容器。恶意行为的判断采用规则过滤+AI判断形式。AI采用基于transform架构的预训练模型进行二次训练，通过对distil-bert进行二次训练，产出对特定漏洞敏感的模型。通过该模型能够识别出容器内可能执行的docker逃逸，反向shell,ssh连接等恶意的操作。敏感日志采用go语言进行编写，通过调用kerbernets的api接口，循环获取所有pod的日志，并通过规则过滤出其中的敏感日志，例如像登录日志，pod创建日志等。目前该项目按照要求对k8s集群恶意行为监测率为70左右，并成功进入西湖论剑线下赛决赛。

#### spring历史漏洞

Jolokia XXE任意文件读取， SpEL 表达式注入漏洞，Spring Boot Actuator 命令执行漏洞，headdump文件信息泄露

#### shiro历史漏洞

身份验证绕过，利用硬编码的密钥构造`rememberMe`参数，进行反序列化攻击 550,721

#### php命令执行函数区别

```
system 函数执行有回显，可将结果显示在页面上
passthru 执行有回显，可将执行结果显示在页面上
exec()函数执行无回显，默认返回最后一行结果
shell_exec()函数默认无回显，通过 echo 可将执行结果输出到页面
eval：PHP 4，PHP 5，PHP 7+ 均可用，接收一个参数，将字符串作为PHP代码执行
assert: PHP 4，PHP5，PHP7.2以下均可使用，一般接收一个参数，PHP5.4.8版本后可以接受两个参数
```

php7.1以上assert()被当作了语言结构，而非一个函数。

#### sql注入分类

联合，盲注，报错，堆叠，宽字节，dnslog,偏移注入

#### sql预编译

预编译使用`preparestatement`，对其进行语法分析，编译和优化，其中用户传入的参数用占位符?代替。当语句真正运行时，传过来的参数只会被看成纯文本，不会重新编译，不会被当做sql指令

#### c2的上线方法

smb beacon上线

SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacons连接后，子Beacon从父Beacon获取到任务并发送。

因为连接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中，qwe   `





s\d w

d\

nb所以SMB Beacon相对隐蔽，绕防火墙时可能发挥奇效

中转listener(Reverse TCP Beacon)

HTTP 代理

TCP Beacon(正向)

使用pystinger进行代理转发

#### 登录框如何 测试

爆破/枚举

Sql注入

密码找回功能

未授权登录、认证绕过

目录扫描/目录遍历

#### ESC8

ADCS的http证书接口没有启用NTLM中继保护

#### 定位域控和域管

```
net group "Domain Admins" /domain  
powerview
PSloggedon.exe
BloodHound
```

```
net group "Domain controllers" /Domain 
net time /domain
dns 解析记录查询定位域控
SPN 扫描定位
```

#### 跨域攻击

利用域信任关系

利用sidhistory进行跨域

使用mimikatz获取当前域的SID、父域的SID、子域域管的NTLM信任密钥

#### DCSync

DS-Replication-Get-Changes(1131f6aa-9c07-11d1-f79f-00c04fc2dcd2) 和 DS-Replication-Get-Changes-All(1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)

复制目录更改，复制目录更改所有项

#### 小程序+APP

wuWxapkg.js可以解包小程序

#### 访问控制模型

windows下访问令牌(Access token)和安全描述符

鉴定acl，用户是否有权限访问xxx

#### 同源策略

```
是指在Web浏览器中，允许某个网页脚本访问另一个网页的数据，但前提是这**两个网页必须有相同的URI、主机名和端口号**，一旦两个网站满足上述条件，这两个网站就被认定为具有相同来源。此策略可防止某个网页上的恶意脚本通过该页面的文档对象模型访问另一网页上的敏感数据。
```

#### docker cgroup

在 Linux cgroup 中，`notify_on_release` 是一个特性标志，当其设置为1（启用）时，当 cgroup 中的最后一个任务（进程）结束（退出或附加到其它 cgroup）时，就会触发一个事件。此事件通常是执行一个事先设置好的 `release_agent` 脚本

#### runc

行 docker 的容器环境，普通用户可以通过特殊构建的镜像，运行后改写主机上的 runc,从而进一步进行入侵操作

在这个漏洞中，我们可以看到它需要满足几个条件：

1. 容器能够通过入口`/proc/self/exe`指向主机中的 runc
2. 容器允许用户自行任意指定，将其中的恶意代码伪装成普通文件
3. 容器中的用户 UID 在主机中的映射 UID 同样具有较高权限，否则即使 runc 被暴露，也会因为容器中用户权限不足而无法访问

#### etcd未授权

在启动etcd时，如果没有指定 --client-cert-auth 参数打开证书校验，并且没有通过iptables / 防火墙等实施访问控制，etcd的接口和数据就会直接暴露给外部黑客

#### mssql

xpcmdshell - sp_oacreate

`xp_regwrite` 存储过程用来写入注册表，我们可以通过该过程实现镜像劫持、写入启动项等操作。

`xp_regwrite` 的利用条件如下：

- • MSSQL 服务器进程未降权
- • 依赖于 xpstar.dll



































记录文件名，数据库

